<!doctype html>
<html>
  <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Leetcode Python solutions</title>
  <meta name="author" content="Claire" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  
  <link rel="icon" href="/favicon.ico" />
  
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.tailwindcss.com"></script>
<meta name="generator" content="Hexo 7.1.1"></head>

  <body class="relative pb-8 min-h-screen border-t-2 border-black">
    <header class="shadow-sm bg-white">
  <div class="flex justify-between mx-auto max-w-3xl py-2">
    <div class="flex items-center">
      <div class="w-8 h-8">
        <a href="/">
          <img src="/logo.svg" alt="Logo" />
        </a>
      </div>
      <h1 class="ml-4"><a href="/" title="Leetcode Python solutions">Leetcode Python solutions</a></h1>
    </div>
    <ul class="flex items-center justify-end">
      
      <li class="ml-4"><a href="/" title="Home">Home</a></li>
      
      <li class="ml-4"><a href="/about/" title="About">About</a></li>
      
      <li class="ml-4"><a href="/archives/" title="Archives">Archives</a></li>
      
      <li class="ml-4"><a href="/tags/" title="Tags">Tags</a></li>
      
    </ul>
  </div>
</header>

    <main>
      <div class="mx-auto max-w-3xl"><div class="py-8 post">
  <h1 class="text-3xl font-semibold">20240321 backtracking-6</h1>
  <article class="post-content"><h2 id="回溯-day6"><a href="#回溯-day6" class="headerlink" title="回溯 day6"></a>回溯 day6</h2><h3 id="1-hard题-重新安排行程-332-这道题二刷的时候再刷"><a href="#1-hard题-重新安排行程-332-这道题二刷的时候再刷" class="headerlink" title="1. hard题 重新安排行程 #332 这道题二刷的时候再刷"></a>1. hard题 重新安排行程 #332 这道题二刷的时候再刷</h3><p><a target="_blank" rel="noopener" href="https://programmercarl.com/0332.%E9%87%8D%E6%96%B0%E5%AE%89%E6%8E%92%E8%A1%8C%E7%A8%8B.html#%E7%AE%97%E6%B3%95%E5%85%AC%E5%BC%80%E8%AF%BE">卡哥算法</a></p>
<h3 id="2-hard题-N皇后-51-二维递归"><a href="#2-hard题-N皇后-51-二维递归" class="headerlink" title="2. hard题 N皇后 #51 二维递归"></a>2. hard题 N皇后 #51 二维递归</h3><p>首先来看一下皇后们的约束条件：</p>
<ul>
<li>不能同行</li>
<li>不能同列</li>
<li>不能同斜线</li>
</ul>
<p>python语法：深拷贝和浅拷贝的比较</p>
<ol>
<li>一维数组，两种方法都可以：<ul>
<li>copy方法：B &#x3D; A.copy()</li>
<li>切片方法：B &#x3D; A[:]</li>
</ul>
</li>
<li>二维数组，上面两种都不行，都是浅拷贝<ul>
<li>正确方法： B &#x3D; [it.copy() for it in A]</li>
</ul>
</li>
</ol>
<h3 id="一个大坑：二维数组创建的时候，千万不能用"><a href="#一个大坑：二维数组创建的时候，千万不能用" class="headerlink" title="一个大坑：二维数组创建的时候，千万不能用"></a>一个大坑：二维数组创建的时候，千万不能用</h3><p><code>[[&quot;&quot;]*n]*n</code><br>一定要用<br><code>[[&#39;.&#39; for _ in range(n)] for _ in range(n)]</code></p>
<ul>
<li>[[‘.’]*n] * n和[[‘.’ for _ in range(n)] for _ in range(n)]是两种不同的方式来创建一个大小为n x n的二维列表（棋盘）。</li>
</ul>
<ol>
<li>[[‘.’]*n] * n: 这种方式会创建一个大小为n的列表，其中的每个元素都是[‘.’]*n。这里的[‘.’]*n是一个大小为n的列表，其中的每个元素都是’.’。由于列表是引用类型，所以当你将[‘.’]*n赋值给列表的每个元素时，实际上是将所有元素都指向了同一个列表对象。这意味着当你修改其中一个元素时，会影响到其他元素。</li>
<li>[[‘.’ for _ in range(n)] for _ in range(n)]: 这种方式使用了列表推导式，创建了一个大小为n的列表，每个元素都是[‘.’ for _ in range(n)]。这里的[‘.’ for _ in range(n)]是一个大小为n的列表，其中的每个元素都是’.’。由于列表是值类型，所以每个元素都是独立的列表对象，修改其中一个元素不会影响到其他元素。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">solveNQueens</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">str</span>]]:</span><br><span class="line">        self.res = []</span><br><span class="line"></span><br><span class="line">        chessboard = [<span class="string">&#x27;.&#x27;</span>*n] * n</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;chess&quot;</span>,chessboard)</span><br><span class="line"></span><br><span class="line">        self.backtracking(n, chessboard, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> self.res</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">backtracking</span>(<span class="params">self, n, chessboard, row</span>):</span><br><span class="line">        <span class="comment">#  终止条件 收集结果</span></span><br><span class="line">        <span class="keyword">if</span> row == n:</span><br><span class="line">            </span><br><span class="line">            self.res.append(chessboard[:])</span><br><span class="line">        <span class="comment"># 因为row是每行遍历选一个位置，所以col就是列遍历选哪一个位置</span></span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">            <span class="comment"># 如何合法的话，这个位置就放queen</span></span><br><span class="line">            <span class="keyword">if</span> self.isValid(row,col,chessboard):</span><br><span class="line">                chessboard[row] = chessboard[row][:col]+<span class="string">&#x27;Q&#x27;</span>+chessboard[row][col+<span class="number">1</span>:]</span><br><span class="line">                self.backtracking(n, chessboard, row+<span class="number">1</span>)</span><br><span class="line">                chessboard[row] = chessboard[row][:col]+<span class="string">&#x27;.&#x27;</span>+chessboard[row][col+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">isValid</span>(<span class="params">self, row: <span class="built_in">int</span>, col: <span class="built_in">int</span>, chessboard</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查列</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">            <span class="keyword">if</span> chessboard[i][col] == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span>  <span class="comment"># 当前列已经存在皇后，不合法</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(col):</span><br><span class="line">            <span class="keyword">if</span> chessboard[row][i] == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span>  <span class="comment"># 当前列已经存在皇后，不合法</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查 45 度角是否有皇后，因为每层是从上往下遍历，所有只判断左上角45度</span></span><br><span class="line">        i, j = row - <span class="number">1</span>, col - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &gt;= <span class="number">0</span> <span class="keyword">and</span> j &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> chessboard[i][j] == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span>  <span class="comment"># 左上方向已经存在皇后，不合法</span></span><br><span class="line">            i -= <span class="number">1</span></span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查 135 度角是否有皇后，因为每层是从上往下遍历，所有只判断右上角45度</span></span><br><span class="line">        i, j = row - <span class="number">1</span>, col + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &gt;= <span class="number">0</span> <span class="keyword">and</span> j &lt; <span class="built_in">len</span>(chessboard):</span><br><span class="line">            <span class="keyword">if</span> chessboard[i][j] == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span>  <span class="comment"># 右上方向已经存在皇后，不合法</span></span><br><span class="line">            i -= <span class="number">1</span></span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>  <span class="comment"># 当前位置合法</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>踩了一个大坑</strong><br>我自己的代码，用的是二维数组做棋盘，在找到结果的时候，转一维数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">solveNQueens</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">str</span>]]:</span><br><span class="line">        self.res = []</span><br><span class="line"></span><br><span class="line">        chessboard = [[<span class="string">&#x27;.&#x27;</span>]*n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line"></span><br><span class="line">        self.backtracking(n, chessboard, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> self.res</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">backtracking</span>(<span class="params">self, n, chessboard, row</span>):</span><br><span class="line">        <span class="comment">#  终止条件 收集结果</span></span><br><span class="line">        <span class="keyword">if</span> row == n:</span><br><span class="line">            <span class="built_in">print</span>(chessboard)</span><br><span class="line">            d_2 = []</span><br><span class="line">            <span class="comment"># 这里是为了把棋盘的二维转一维</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">                d_2.append(<span class="string">&#x27;&#x27;</span>.join(chessboard[i]))</span><br><span class="line">            <span class="built_in">print</span>(d_2)</span><br><span class="line">            self.res.append(d_2[:])</span><br><span class="line">            <span class="comment"># return</span></span><br><span class="line">        <span class="comment"># 因为row是每行遍历选一个位置，所以col就是列遍历选哪一个位置</span></span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">            <span class="comment"># 如何合法的话，这个位置就放queen</span></span><br><span class="line">            <span class="keyword">if</span> self.isValid(row,col,chessboard):</span><br><span class="line">                <span class="built_in">print</span>(row)</span><br><span class="line">                chessboard[row][col] = <span class="string">&#x27;Q&#x27;</span></span><br><span class="line">                <span class="comment"># print(chessboard)</span></span><br><span class="line">                self.backtracking(n, chessboard, row+<span class="number">1</span>)</span><br><span class="line">                chessboard[row][col] = <span class="string">&#x27;.&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">isValid</span>(<span class="params">self, row: <span class="built_in">int</span>, col: <span class="built_in">int</span>, chessboard</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        n = <span class="built_in">len</span>(chessboard)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                <span class="keyword">if</span> chessboard[i][col] == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">if</span> row - i &gt;= <span class="number">0</span> <span class="keyword">and</span> col - i &gt;= <span class="number">0</span> <span class="keyword">and</span> chessboard[row-i][col-i] == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">if</span> row - i &gt;= <span class="number">0</span> <span class="keyword">and</span> col + i &lt; n <span class="keyword">and</span> chessboard[row-i][col+i] == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<h3 id="3-hard题-解数独-37-三维递归-这道题二刷的时候再刷"><a href="#3-hard题-解数独-37-三维递归-这道题二刷的时候再刷" class="headerlink" title="3. hard题 解数独 #37 三维递归 这道题二刷的时候再刷"></a>3. hard题 解数独 #37 三维递归 这道题二刷的时候再刷</h3><p>思路：</p>
<ul>
<li>本题中棋盘的每一个位置都要放一个数字（而N皇后是一行只放一个皇后），并检查数字是否合法，解数独的树形结构要比N皇后更宽更深。</li>
<li>一个for循环遍历棋盘的行，一个for循环遍历棋盘的列，一行一列确定下来之后，递归遍历这个位置放9个数字的可能性！</li>
<li>注意这里return false的地方，这里放return false 是有讲究的。</li>
</ul>
<p>因为如果一行一列确定下来了，这里尝试了9个数都不行，说明这个棋盘找不到解决数独问题的解！</p>
<p>那么会直接返回， 这也就是为什么没有终止条件也不会永远填不满棋盘而无限递归下去！</p>
<p>卡哥解法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">solveSudoku</span>(<span class="params">self, board: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">str</span>]]</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Do not return anything, modify board in-place instead.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.backtracking(board)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">backtracking</span>(<span class="params">self, board: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">str</span>]]</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="comment"># 若有解，返回True；若无解，返回False</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(board)): <span class="comment"># 遍历行</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(board[<span class="number">0</span>])):  <span class="comment"># 遍历列</span></span><br><span class="line">                <span class="comment"># 若空格内已有数字，跳过</span></span><br><span class="line">                <span class="keyword">if</span> board[i][j] != <span class="string">&#x27;.&#x27;</span>: <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">                    <span class="keyword">if</span> self.is_valid(i, j, k, board):</span><br><span class="line">                        board[i][j] = <span class="built_in">str</span>(k)</span><br><span class="line">                        <span class="keyword">if</span> self.backtracking(board): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                        board[i][j] = <span class="string">&#x27;.&#x27;</span></span><br><span class="line">                <span class="comment"># 若数字1-9都不能成功填入空格，返回False无解</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> <span class="comment"># 有解</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_valid</span>(<span class="params">self, row: <span class="built_in">int</span>, col: <span class="built_in">int</span>, val: <span class="built_in">int</span>, board: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">str</span>]]</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="comment"># 判断同一行是否冲突</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> board[row][i] == <span class="built_in">str</span>(val):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment"># 判断同一列是否冲突</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> board[j][col] == <span class="built_in">str</span>(val):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment"># 判断同一九宫格是否有冲突</span></span><br><span class="line">        start_row = (row // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">        start_col = (col // <span class="number">3</span>) * <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_row, start_row + <span class="number">3</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(start_col, start_col + <span class="number">3</span>):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == <span class="built_in">str</span>(val):</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure></article>
  <div class="flex items-center justify-between text-sm">
    
    <span class="flex items-center">
      
    </span>
    
    <span class="text-gray-500"
      >2024-03-20</span
    >
  </div>
</div>
</div>
    </main>
    <footer class="absolute bottom-2 left-0 right-0">
  <div class="mx-auto max-w-3xl flex items-center justify-between">
    <p class="text-sm text-gray-400">
       Copyright &copy;  2024 Claire
    </p>
    <p class="text-sm text-gray-400">
      Powered by
      <a
        href="https://hexo.io"
        target="_blank"
        class="text-orange-300 underline"
        >Hexo</a
      >
      • Theme
      <a
        href="https://github.com/mintsweet/hexo-theme-mints"
        target="_blank"
        class="text-orange-300 underline"
        >Mints</a
      >
    </p>
  </div>
</footer>

  </body>
</html>
